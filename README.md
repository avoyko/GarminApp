# Приложение для экспорта информации о показателях здоровья со смарт-часов и учета данных показателей при планировании нагрузки

### Разделение на модули

Приложение разделено на 5 логических модулей:

1. app
    * Основное предназначение - обеспечение корректной работы сервера, на котором приложение запускается
2. polar_api
    * В данном модуле содержится вся логика работы с API Polar (то есть авторизация пользователя и получение данных с
      серверов вендора)
3. database
    * Эта часть проекта обеспечивает работу с базой данных, созданной под нашего пользователя, и таблицами в ней (в
      качестве СУБД была выбрана MySQL)
4. model
    * Здесь приведена реализация модели для построений рекомендаций пользователю
5. сalendar_scheduler
    * В этой части приложения имплементировано взаимодействие с API Google-Calendar

### Pipeline

Исполнение программного кода происходит по следующей схеме:

1. Пользователь запускает проект и переходит по адресу, на котором развернута серверная часть приложения (в нашем случае
   это http://localhost:5002/)


2. Если пользователь не зарегистрирован, то с помощью протокола OAuth2 происходит авторизация пользователя, в результате
   которой мы получаем access-token для корректной работы с серверами Polar


3. Далее, приложение собирает последние данные пользователя о его дневной активности, тренировках, физическом состоянии
   и сне


4. На следующем этапе мы обновляем базу данных, привязанную к нашему пользователю, или в случае отсутствия создаем новую


5. После обновления данных мы преобразуем информацию из БД в .csv файл и подготавливаем данные для обработки моделью


6. Модель принимает препроцессированные данные и на основе внутренних алгоритмов выдает несколько рекомендаций
   относительно расписания пользователя


7. Полученные рекомендации преобразуются в текст и автоматически выставляются пользователю в его Google Calendar

### Используемые фреймворки и библиотеки

1. Crow
    * Фреймворк для создания HTTP-сервисов, во многом похожий на Flask
2. yaml-cpp
    * Библиотека для работы с .yaml файлами (в файл такого формата сохраняется access-token)
3. Cpr
    * Фреймворк для работы с основными HTTP-запросами
4. MySQL Connector/C++
    * Библиотека от Oracle, обеспечивающая работу с БД для приложения на С++
5. frozen
    * Небольшая библиотека, позволяющая инициализировать контейнеры типа unordered-map/string в compile-time
6. gtest
    * Библиотека от Google для написания тестов
7. Tensorflow, sklearn, keras_tuner
    * Библиотеки, требуемые для построения рекомендательной модели
8. ncurses
    * Библиотека для написанияя графического интерфейса
9. Google-api-python-client, google-auth-httplib2, google-auth-oauthlib
    * Python-библиотеки, позволяющие работать с API Google и производить авторизацию пользова-
      теля в его аккаунте Google.
10. Boost 
    * По большей части использовался в проекте для удобного форматирования строк
      (boost::format)

### Запуск приложения



Для запуска проекта нужно склонировать этот репозиторий:
```
git clone https://github.com/avoyko/PolarDataAnalysis
```

И затем требуется поднять docker-контейнер (сборка может занять в районе 7-10 минут):
```
cd containers
docker compose up
```

